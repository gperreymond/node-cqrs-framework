version: '2'

services:

  cqrs_test:
    container_name: cqrs.test
    build:
      context: ./../../
      dockerfile: docker/test/docker-file
    working_dir: /usr/app
    links:
      - rethinkdb_cqrs_test
      - rabbitmq_cqrs_test
    depends_on:
      - rethinkdb_cqrs_test
      - rabbitmq_cqrs_test

  rethinkdb_cqrs_test:
    container_name: rethinkdb.cqrs.test
    image: "rethinkdb:latest"
    privileged: true
    links:
      - rabbitmq_cqrs_test
    networks:
      - network_cqrs_test
    ports:
      - "8080:8080"
      - "28015:28015"

  rabbitmq_cqrs_test:
    container_name: rabbitmq.cqrs.test
    image: "rabbitmq:management"
    privileged: true
    networks:
      - network_cqrs_test
    ports:
      - "5672:5672"
      - "15672:15672"

networks:
  network_cqrs_test:
    driver: bridge
